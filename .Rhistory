setwd("G:/My Drive/TMC_WenboLi/Data/Bioinformatic/P400_TIP60_diffgene_analysis")
source('~/.active-rstudio-document')
library(GenomicRanges)
library(magrittr)
library(ggplot2)
library(data.table)
setwd("C:/Feng/Groseq_pipeline/groseq_pipe_line")
setwd("C:/Feng/Groseq_pipeline")
load('r.func/ImportBiopacks.rdata')
ImportBiopacks('GenomicRanges')
install.packages('MASS')
# Library -----------------------------------------------------------------
library(GenomicRanges)
def.exp.p400 <- fread('P400.diffoutput.txt')
rm(def.exp.p400)
dif.exp.p400 <- fread('P400.diffoutput.txt')
View(dif.exp.p400)
file = 'P400.diffoutput.txt'
coordinate = 'coordinates/gencode.v19.annotation.geneonly.gtf'
rm(dif.exp.p400)
dif.exp <- fread(file)
coordinate <- fread(coordinate.file) %>% makeGRangesFromDataFrame()
coordinate.file = 'coordinates/gencode.v19.annotation.geneonly.gtf'
coordinate <- fread(coordinate.file) %>% makeGRangesFromDataFrame()
coordinate <- fread(coordinate.file)
head(coordinate)
coordinate <- fread(coordinate.file) %>% `colnames<-`(c('seqname','source','feature','start','end','score','strand','frame','attribute'))
coordinate <- makeGRangesFromDataFrame(coordinate)
head(coordinate)
coordinate <- fread(coordinate.file) %>% `colnames<-`(c('seqname','source','feature','start','end','score','strand','frame','attribute'))
coordinate <- makeGRangesFromDataFrame(coordinate,keep.extra.columns = T)
head(coordinate)
attribute.type <- strsplit(coordinate$attribute[1],';')
attribute.type
attribute.type <- strsplit(coordinate$attribute[1],';') %>% unlist()
attribute.type <- strsplit(coordinate$attribute[1],';') %>% unlist() %>% str_replace_all(' \\"\\.*\\"','')
attribute.type <- strsplit(coordinate$attribute[1],';') %>% unlist() %>% str_replace(' \\"\\.*\\"','')
library(stringr)
attribute.type <- strsplit(coordinate$attribute[1],';') %>% unlist() %>% str_replace(' \\"\\.*\\"','')
attribute.type
attribute.type <- strsplit(coordinate$attribute[1],';') %>% unlist() %>% str_replace_all('\\"\\.*\\"','')
attribute.type <- strsplit(coordinate$attribute[1],';') %>% unlist() %>% str_replace_all('\\".*\\"','')
attribute.type <- strsplit(coordinate$attribute[1],';') %>% unlist() %>% str_replace_all( '\\".*\\"','')
attribute.type
attribute.type <- strsplit(coordinate$attribute[1],';') %>% unlist() %>% str_replace_all( '\\".*\\"','') %>% str_replace_all(' ','')
i <- "gene_id"
str_extract('aabaac','a\\w')
str_extract('aabaac','aa\\w')
attribute.type <- strsplit(coordinate$attribute[1],';') %>% unlist() %>% str_replace_all( '\\".*\\"','')
i <- "gene_id "
temp <- str_extract(coordinate$attribute,paste0(i,'\\".*;'))
temp %>% head()
temp <- str_extract(coordinate$attribute,paste0(i,'\\".*ï¼Ÿ;'))
temp <- str_extract(coordinate$attribute,paste0(i,'\\".*?;'))
temp %>% head()
temp <- str_extract(coordinate$attribute,paste0(i,'\\".*?;')) %>% str_replace_all(i,'') %>% str_replace_all('\"','') %>% str_replace_all(' ','')
temp %>% head()
temp <- str_extract(coordinate$attribute,paste0(i,'\\".*?;')) %>%
str_replace_all(i,'') %>%
str_replace_all('\"','') %>%
str_replace_all(';','') %>%
str_replace_all(' ','')
attribute.type <- strsplit(coordinate$attribute[1],';')
attribute.type
str_extract_all('aabbabac','a\\w')
attribute.list <- list(NULL)
attribute <- list(NULL)
for (i in seq(length(attribute.type))) {
name <- attribute.type[i]
temp <- str_extract(coordinate$attribute, paste0(i, '\\".*?;')) %>%
str_replace_all(i, '') %>%
str_replace_all('\"', '') %>%
str_replace_all(';', '') %>%
str_replace_all(' ', '')
attribute.list[[i]] <- temp
}
str_rname
name
attribute.type <- strsplit(coordinate$attribute[1],';') %>% unlist() %>% str_replace_all( '\\".*\\"','')
attribute <- list(NULL)
for (i in seq(length(attribute.type))) {
name <- attribute.type[i]
temp <- str_extract(coordinate$attribute, paste0(i, '\\".*?;')) %>%
str_replace_all(i, '') %>%
str_replace_all('\"', '') %>%
str_replace_all(';', '') %>%
str_replace_all(' ', '')
attribute.list[[i]] <- temp
}
attribute.type
seq(length(attribute.type))
i <- 1
name <- attribute.type[i]
temp <- str_extract(coordinate$attribute, paste0(i, '\\".*?;')) %>%
str_replace_all(i, '') %>%
str_replace_all('\"', '') %>%
str_replace_all(';', '') %>%
str_replace_all(' ', '')
attribute <- list(NULL)
for (i in seq(length(attribute.type))) {
name <- attribute.type[i]
temp <- str_extract(coordinate$attribute, paste0(name, '\\".*?;')) %>%
str_replace_all(i, '') %>%
str_replace_all('\"', '') %>%
str_replace_all(';', '') %>%
str_replace_all(' ', '')
attribute.list[[i]] <- temp
}
temp <- str_extract(coordinate$attribute, paste0(name, '\\".*?;')) %>%
str_replace_all(i, '') %>%
str_replace_all('\"', '') %>%
str_replace_all(';', '') %>%
str_replace_all(' ', '')
temp <- str_extract(coordinate$attribute, paste0(name, '\\".*?;'))
for (i in seq(length(attribute.type))) {
name <- attribute.type[i]
temp <- str_extract(coordinate$attribute, paste0(name, '\\".*?;')) %>%
str_replace_all(name, '') %>%
str_replace_all('\"', '') %>%
str_replace_all(';', '') %>%
str_replace_all(' ', '')
attribute.list[[i]] <- temp
}
attribute <- as.data.table(attribute.list) %>% `colnames<-`(attribute.type)
View(attribute)
coordinate$attribute <- NULL
mcols(coordinate) <- cbind(mcols(coordinate), attribute)
head(coordinate)
colnames(attribute)
source('G:/My Drive/TMC_WenboLi/Data/Bioinformatic/P400_TIP60_diffgene_analysis/DiffGeneCat.R', echo=TRUE)
dif.exp <- fread(diff.file)
coordinate <- fread(coordinate.file) %>% `colnames<-`(c('seqname','source','feature','start','end','score','strand','frame','attribute'))
coordinate <- makeGRangesFromDataFrame(coordinate,keep.extra.columns = T)
attribute.type <- strsplit(coordinate$attribute[1],';') %>% unlist() %>% str_replace_all( '\\".*\\"','')
attribute <- list(NULL)
for (i in seq(length(attribute.type))) {
name <- attribute.type[i]
temp <- str_extract(coordinate$attribute, paste0(name, '\\".*?;')) %>%
str_replace_all(name, '') %>%
str_replace_all('\"', '') %>%
str_replace_all(';', '') %>%
str_replace_all('', '') %>%
str_replace_all('\\t','')
attribute.list[[i]] <- temp
}
for (i in seq(length(attribute.type))) {
name <- attribute.type[i]
temp <- str_extract(coordinate$attribute, paste0(name, '\\".*?;')) %>%
str_replace_all(name, '') %>%
str_replace_all('\"', '') %>%
str_replace_all(';', '') %>%
str_replace_all('', '') %>%
str_replace_all('\\t','')
attribute[[i]] <- temp
}
temp <- str_extract(coordinate$attribute, paste0(name, '\\".*?;')) %>%
str_replace_all(name, '') %>%
str_replace_all('\"', '') %>%
str_replace_all(';', '') %>%
str_replace_all('', '') %>%
str_replace_all('\\t','')
# Library -----------------------------------------------------------------
library(GenomicRanges)
library(magrittr)
library(ggplot2)
library(data.table)
library(RColorBrewer)
library(stringr)
temp <- str_extract(coordinate$attribute, paste0(name, '\\".*?;')) %>%
str_replace_all(name, '') %>%
str_replace_all('\"', '') %>%
str_replace_all(';', '') %>%
str_replace_all('', '') %>%
str_replace_all('\\t','')
(NULL)
for (i in seq(length(attribute.type))) {
name <- attribute.type[i]
temp <- str_extract(coordinate$attribute, paste0(name, '\\".*?;')) %>%
str_replace_all(name, '') %>%
str_replace_all('\"', '') %>%
str_replace_all(';', '') %>%
str_replace_all(' ', '') %>%
str_replace_all('\\t','')
attribute[[i]] <- temp
}
attribute <- as.data.table(attribute.list) %>% `colnames<-`(attribute.type)
for (i in seq(length(attribute.type))) {
name <- attribute.type[i]
temp <- str_extract(coordinate$attribute, paste0(name, '\\".*?;')) %>%
str_replace_all(name, '') %>%
str_replace_all('\"', '') %>%
str_replace_all(';', '') %>%
str_replace_all(' ', '') %>%
attribute[[i]] <- temp
}
attribute.type <- strsplit(coordinate$attribute[1],';') %>% unlist() %>% str_replace_all( '\\".*\\"','')
attribute <- list(NULL)
for (i in seq(length(attribute.type))) {
name <- attribute.type[i]
temp <- str_extract(coordinate$attribute, paste0(name, '\\".*?;')) %>%
str_replace_all(name, '') %>%
str_replace_all('\"', '') %>%
str_replace_all(';', '') %>%
str_replace_all(' ', '') %>%
attribute[[i]] <- temp
}
dif.exp <- fread(diff.file)
coordinate <- fread(coordinate.file) %>% `colnames<-`(c('seqname','source','feature','start','end','score','strand','frame','attribute'))
coordinate <- makeGRangesFromDataFrame(coordinate,keep.extra.columns = T)
attribute.type <- strsplit(coordinate$attribute[1],';') %>% unlist() %>% str_replace_all( '\\".*\\"','')
attribute <- list(NULL)
for (i in seq(length(attribute.type))) {
name <- attribute.type[i]
temp <- str_extract(coordinate$attribute, paste0(name, '\\".*?;')) %>%
str_replace_all(name, '') %>%
str_replace_all('\"', '') %>%
str_replace_all(';', '') %>%
str_replace_all(' ', '') %>%
attribute[[i]] <- temp
}
for (i in seq(length(attribute.type))) {
name <- attribute.type[i]
temp <- str_extract(coordinate$attribute, paste0(name, '\\".*?;')) %>%
str_replace_all(name, '') %>%
str_replace_all('\"', '') %>%
str_replace_all(';', '') %>%
str_replace_all(' ', '')
attribute[[i]] <- temp
}
temp <- str_extract(coordinate$attribute, paste0(name, '\\".*?;')) %>%
str_replace_all(name, '') %>%
str_replace_all('\"', '') %>%
str_replace_all(';', '') %>%
str_replace_all(' ', '')
coordinate$attribute <- NULL
mcols(coordinate) <- cbind(mcols(coordinate), attribute)
head(coordinate)
str_replace_all(attribute.type,' ','')
attribute <- as.data.table(attribute) %>% `colnames<-`(str_replace_all(attribute.type,' ',''))
coordinate$attribute <- NULL
mcols(coordinate) <- cbind(mcols(coordinate), attribute)
head(coordinate)
head(diff.file)
head(diff.exp)
# Diff expression analysis (start from homer diff output) -----------------
dif.exp <- fread(diff.file)
head(diff.exp)
head(dif.exp)
Info <- dif.exp %>% colnames() %>% `[`(1)
Info <- colnames(dif.exp)[1]
dif.exp <- makeGRangesFromDataFrame(dif.exp,keep.extra.columns = T)
head(dif.exp)
# Diff expression analysis (start from homer diff output) -----------------
dif.exp <- fread(diff.file)
Info <- colnames(dif.exp)[1]
dif.exp[1] <- NULL
dif.exp <- makeGRangesFromDataFrame(dif.exp,keep.extra.columns = T)
dif.exp[1,] <- NULL
dif.exp[,1] <- NULL
# Diff expression analysis (start from homer diff output) -----------------
dif.exp <- fread(diff.file)
Info <- colnames(dif.exp)[1]
dif.exp[,1]
dif.exp[,-1]
dif.exp <- makeGRangesFromDataFrame(dif.exp[,-1],keep.extra.columns = T)
?merge
dif.exp <- makeGRangesFromDataFrame(dif.exp[,-1],keep.extra.columns = T) %>% sort()
coordinate <- coordinate %>% sort()
head(coordinate)
# Change coordinate to GR -------------------------------------------------
coordinate <- fread(coordinate.file) %>% `colnames<-`(c('seqname','source','feature','start','end','score','strand','frame','attribute'))
coordinate <- makeGRangesFromDataFrame(coordinate,keep.extra.columns = T) %>% sort()
attribute.type <- strsplit(coordinate$attribute[1],';') %>% unlist() %>% str_replace_all( '\\".*\\"','')
attribute <- list(NULL)
for (i in seq(length(attribute.type))) {
name <- attribute.type[i]
temp <- str_extract(coordinate$attribute, paste0(name, '\\".*?;')) %>%
str_replace_all(name, '') %>%
str_replace_all('\"', '') %>%
str_replace_all(';', '') %>%
str_replace_all(' ', '')
attribute[[i]] <- temp
}
attribute <- as.data.table(attribute) %>% `colnames<-`(str_replace_all(attribute.type,' ',''))
coordinate$attribute <- NULL
head(attribute)
mcols(coordinate) <- cbind(mcols(coordinate), attribute)
head(coordinate)
head(dif.exp)
table(coordinate$gene_type)
source('G:/My Drive/TMC_WenboLi/Data/Bioinformatic/P400_TIP60_diffgene_analysis/DiffGeneCat.R')
# Library -----------------------------------------------------------------
library(GenomicRanges)
library(magrittr)
library(ggplot2)
library(data.table)
library(RColorBrewer)
library(stringr)
head(dif.exp)
# Diff expression analysis (start from homer diff output) -----------------
dif.exp <- fread(diff.file)
Info <- colnames(dif.exp)[1]
dif.exp <- makeGRangesFromDataFrame(dif.exp[,-1],keep.extra.columns = T) %>% sort()
head(dif.exp)
head(coordinate)
test <- as.data.table(dif.exp)
head(test)
dif.tb <- cbind(as.data.table(dif.exp),mcols(coordinate))
rm(test)
sum(dif.tb$Homer.tags.Hela.siP400.rpt1.GRO...6600190.0.total.)
Info
test <- fread('P400.countTable.txt')
head(test)
test <- fread('P400.countTable.txt') %>% makeGRangesFromDataFrame()
head(sort(test))
test <- fread('P400.countTable.txt') %>% makeGRangesFromDataFrame(keep.extra.columns = T) %>% sort()
head(test)
View(test)
head(test)
head(dif.tb)
library(DESeq2)
ImportBiopacks('DESeq2')
load("C:/Feng/Groseq_pipeline/r.func/DefExp.rdata")
DefExp()
DefExp
test <- fread('P400.countTable.txt') %>% DefExp()
test <- DefExp('P400.countTable.txt',groups = c('siCTL','siCTL','siP400','siP400'),ref = 'siCTL')
head(test)
test <- makeGRangesFromDataFrame(test) %>% sort() %>% head()
test
test <- DefExp('P400.countTable.txt',groups = c('siCTL','siCTL','siP400','siP400'),ref = 'siCTL')
test <- makeGRangesFromDataFrame(test,keep.extra.columns = T) %>% sort()
head(test)
head(dif.exp)
dif.exp[999]
dif.exp[998]
test[998]
head(dif.tb)
table
table(dif.tb$gene_type)
head(test)
library(GenomicRanges)
library(magrittr)
library(ggplot2)
library(data.table)
library(RColorBrewer)
library(stringr)
colnames(dif.tb)
table(dif.tb$gene_type)
table(dif.tb["siCTL.vs..siP400.adj..p.value" < 0.05, ]$gene_type)
dif.tb["siCTL.vs..siP400.adj..p.value" < 0.05, ]
summary(dif.tb$siCTL.vs..siP400.adj..p.value)
summary(test$padj)
temp <- fread('P400.countTable.txt')
head(temp)
DefExp
temp <- fread('P400.countTable.txt')
colnames(temp)
temp <- temp[`Homer.tags/Hela-siCTL-rpt1-GRO/ (9033367.0 total)` > 0 & `Homer.tags/Hela-siCTL-rpt2-GRO/ (10709893.0 total)` > 0, ]
# Diff expression analysis (start from homer diff output) -----------------
dif.exp <- fread('P400.countTable.txt')
Info <- colnames(dif.exp)[1]
dif.exp <- makeGRangesFromDataFrame(dif.exp[,-1],keep.extra.columns = T) %>% sort()
dif.tb <- cbind(as.data.table(dif.exp),mcols(coordinate))
head(dif.tb)
dif.tb <- dif.tb[`Homer.tags/Hela-siCTL-rpt1-GRO/ (9033367.0 total)` > 0 & `Homer.tags/Hela-siCTL-rpt2-GRO/ (10709893.0 total)` > 0, ]
dif.tb <- dif.tb["Homer.tags.Hela.siCTL.rpt1.GRO...9033367.0.total." > 0 & "Homer.tags.Hela.siCTL.rpt2.GRO...10709893.0.total." > 0, ]
# Diff expression analysis (start from homer diff output) -----------------
dif.exp <- fread('P400.countTable.txt')
head(dif.exp)
dif.exp <- makeGRangesFromDataFrame(dif.exp[,-1],keep.extra.columns = T) %>% sort()
dif.tb <- cbind(as.data.table(dif.exp),mcols(coordinate))
head(dif.tb)
summary(dif.tb$Homer.tags.Hela.siCTL.rpt1.GRO...9033367.0.total.)
temp <- dif.tb["Homer.tags.Hela.siCTL.rpt1.GRO...9033367.0.total." > 0 & "Homer.tags.Hela.siCTL.rpt2.GRO...10709893.0.total." > 0, ]
head(temp)
dif.tb <- cbind(as.data.table(dif.exp),mcols(coordinate))
temp <- dif.tb["Homer.tags.Hela.siCTL.rpt1.GRO...9033367.0.total." > 0 & "Homer.tags.Hela.siCTL.rpt2.GRO...10709893.0.total." > 0, ]
dif.exp <- makeGRangesFromDataFrame(dif.exp[,-1],keep.extra.columns = T) %>% sort()
dif.tb <- cbind(as.data.table(dif.exp),mcols(coordinate))
nrow(dif.tb)
temp <- dif.tb["Homer.tags.Hela.siCTL.rpt1.GRO...9033367.0.total." > 0 & "Homer.tags.Hela.siCTL.rpt2.GRO...10709893.0.total." > 0, ]
nrow(temp)
View(dif.tb)
dif.tb <- cbind(as.data.table(dif.exp),mcols(coordinate)) %>% as.data.table()
temp <- dif.tb["Homer.tags.Hela.siCTL.rpt1.GRO...9033367.0.total." > 0 & "Homer.tags.Hela.siCTL.rpt2.GRO...10709893.0.total." > 0, ]
head(dif.tb)
test <- dif.tb[Homer.tags.Hela.siCTL.rpt1.GRO...9033367.0.total. > 0 & Homer.tags.Hela.siCTL.rpt2.GRO...10709893.0.total. >0, ]
table(test$gene_type)
table(dif.tb$gene_type)
dif.tb <- cbind(mcols(coordinate),as.data.table(dif.exp)) %>% as.data.table()
write.csv(dif.tb,'test.csv')
test <- fread('test.csv')
head(test)
write.csv(dif.tb,'test.csv',row.names = F)
test <- fread('test.csv')
head(test)
test <- DefExp('test.csv',groups = c('siCTL','siCTL','siP400','siP400'),ref = 'siCTL')
temp <- fread('test.csv')
nrow(temp)
dif.tb <- dif.tb[Homer.tags.Hela.siCTL.rpt1.GRO...9033367.0.total. > 0 & Homer.tags.Hela.siCTL.rpt2.GRO...10709893.0.total. >0 , ]
write.csv(dif.tb,'test.csv',row.names = F)
temp <- fread('test.csv')
head(temp)
?fread
test <- DefExp('test.csv',groups = c('siCTL','siCTL','siP400','siP400'),ref = 'siCTL')
head(test)
summary(test$padj)
sum(test$padj < 0.05)
sum(test$padj < 0.05, na.rm = T)
table(test[padj< 0.05,]$gene_type)
table(test$gene_type)
colnames(dif.tb)
groups <- c('siCTL','siCTL','siP400','siP400')
groupn <- length(groups)
tail(colnames(dif.tb),groupn)
total.reads <- tail(colnames(dif.tb),groupn) %>% str_extract('\\d+.0.')
total.reads <- tail(colnames(dif.tb),groupn) %>% str_extract('\\d+.0')
total.reads <- tail(colnames(dif.tb),groupn) %>% str_extract('\\d+.0') %>% as.numeric()
total.reads <- tail(colnames(dif.tb),groupn) %>% str_extract('\\d+\.0') %>% as.numeric()
total.reads <- tail(colnames(dif.tb),groupn) %>% str_extract('\\d+\\.0') %>% as.numeric()
total.reads <- tail(colnames(dif.tb),groupn) %>% str_extract('\\d+\\.0') %>% as.numeric() %>% sum()
rpkm <- dif.tb[,tail(seq(ncol(dif.tb)),groupn)]
rpkm <- dif.tb[,tail(seq(ncol(dif.tb)),groupn),with=F]
head(dif.tb)
head(rpkm)
rpkm <- dif.tb[,tail(seq(ncol(dif.tb)),groupn),with=F] %>% rowSums()
rpkm <- dif.tb[,tail(seq(ncol(dif.tb)),groupn),with=F] %>% rowSums()/dif.tb$width
rpkm <- dif.tb[,tail(seq(ncol(dif.tb)),groupn),with=F] %>% rowSums()*1000/dif.tb$width %>%
dif.tb <- dif.tb[Homer.tags.Hela.siCTL.rpt1.GRO...9033367.0.total. > 0 & Homer.tags.Hela.siCTL.rpt2.GRO...10709893.0.total. >0 , ]
rpkm <- dif.tb[,tail(seq(ncol(dif.tb)),groupn),with=F] %>% rowSums()*1000/dif.tb$width
total.reads <- tail(colnames(dif.tb),groupn) %>% str_extract('\\d+\\.0') %>% as.numeric() %>% sum()/1000000
rpkm <- dif.tb[,tail(seq(ncol(dif.tb)),groupn),with=F] %>% rowSums()*1000/(dif.tb$width*total.reads)
dif.tb <- dif.tb[rpkm >= min.exp, ]
min.exp <- 0.5
dif.tb <- dif.tb[rpkm >= min.exp, ]
dif.exp <- fread('P400.countTable.txt')
Info <- colnames(dif.exp)[1]
dif.exp <- makeGRangesFromDataFrame(dif.exp[,-1],keep.extra.columns = T) %>% sort()
dif.tb <- cbind(mcols(coordinate),as.data.table(dif.exp)) %>% as.data.table()
total.reads <- tail(colnames(dif.tb),groupn) %>% str_extract('\\d+\\.0') %>% as.numeric() %>% sum()/1000000
rpkm <- dif.tb[,tail(seq(ncol(dif.tb)),groupn),with=F] %>% rowSums()*1000/(dif.tb$width*total.reads)
dif.tb <- dif.tb[rpkm >= min.exp, ]
table(dif.tb$gene_type)
min.exp <- 0.1
dif.exp <- fread('P400.countTable.txt')
Info <- colnames(dif.exp)[1]
dif.exp <- makeGRangesFromDataFrame(dif.exp[,-1],keep.extra.columns = T) %>% sort()
dif.tb <- cbind(mcols(coordinate),as.data.table(dif.exp)) %>% as.data.table()
total.reads <- tail(colnames(dif.tb),groupn) %>% str_extract('\\d+\\.0') %>% as.numeric() %>% sum()/1000000
rpkm <- dif.tb[,tail(seq(ncol(dif.tb)),groupn),with=F] %>% rowSums()*1000/(dif.tb$width*total.reads)
dif.tb <- dif.tb[rpkm >= min.exp, ]
table(dif.tb$gene_type)
dif.tb <- DefExp('temp.csv',groups = c('siCTL','siCTL','siP400','siP400'),ref = 'siCTL')
write.csv(dif.tb,'temp.csv',row.names = F)
dif.tb <- DefExp('temp.csv',groups = c('siCTL','siCTL','siP400','siP400'),ref = 'siCTL')
head(dif.tb)
test <- ggplot(mtcars, aes_all(x = factor(1), fill = factor(cyl)))
library(GenomicRanges)
library(magrittr)
library(ggplot2)
library(data.table)
library(RColorBrewer)
library(stringr)
test <- ggplot(mtcars, aes_all(x = factor(1), fill = factor(cyl))) + geom_bar(width = 1)
test <- ggplot(mtcars, aes(x = factor(1), fill = factor(cyl))) + geom_bar(width = 1)
test
test + coord_polar()
test <- ggplot(mtcars, aes(x = factor(cyl))) + geom_bar(width = 1, colour = "black")
test
test + coord_polar()
?coord_polar
test <- ggplot(mtcars, aes(x = factor(1), fill = factor(cyl))) + geom_bar(width = 1)
test
test <- ggplot(mtcars, aes(x = factor(1), fill = cyl)) + geom_bar(width = 1)
test
test <- ggplot(mtcars, aes(x = factor(1), y = cyl)) + geom_bar(width = 1)
test <- ggplot(mtcars, aes(x = factor(1), y = factor(cyl))) + geom_bar(width = 1)
head(dif.tb)
test <- ggplot(dif.tb, aes(x = factor(1), fill = factor(gene_type))) + geom_bar(width = 1)
test
test + coord_polar()
test + coord_polar(theta = 'y')
test + coord_polar()
temp <- dif.tb
temp$regulation <- 'NC'
temp[padj < 0.05 & log2FoldChange > 0,]$regulation <- 'Increase'
temp[padj < 0.05 & log2FoldChange > 0,]$regulation <- 'Decrease'
temp[padj < 0.05 & log2FoldChange > 0,]$regulation <- 'Increase'
temp[padj < 0.05 & log2FoldChange < 0,]$regulation <- 'Decrease'
table(temp$regulation)
test + geom_bar(width = 0.9, position = 'fill')
test <- ggplot(dif.tb, aes(x = gene_type, fill = factor(gene_type)))
test + geom_bar(width = 0.9, position = 'fill')
test <- ggplot(dif.tb, aes(x = gene_type, fill = regulation))
test + geom_bar(width = 0.9, position = 'fill') + coord_polar(theta = 'y')
test <- ggplot(temp,(x = gene_type, fill = regulation))
test + geom_bar(width = 0.9, position = 'fill') + coord_polar(theta = 'y')
test <- ggplot(temp,aes(x = gene_type, fill = regulation))
test + geom_bar(width = 0.9, position = 'fill') + coord_polar(theta = 'y')
test <- ggplot(temp,aes(x = gene_type, fill = regulation))
test + geom_bar(width = 0.9, position = 'fill')
test + geom_bar(width = 0.9)
