theme(axis.text.x = element_text(angle = 90, hjust = 1),
plot.title = element_text(hjust = 0.5))
plot <- ggplot(plot.table[count > 200,],aes(x =gene_type, y= N, fill = express, label = experc))
plot + geom_bar(stat = 'identity') + theme_xf +
labs(title = 'test',x=NULL) +
geom_text(aes(y = count),vjust = -0.5, size =3)+
scale_fill_manual(values = c('firebrick3','grey50'))+
theme(axis.text.x = element_text(angle = 90, hjust = 1),
plot.title = element_text(hjust = 0.5))
plot + geom_bar(stat = 'identity') + theme_xf +
labs(title = 'test',x=NULL) +
geom_text(aes(y = count),vjust = -0.5, size =3.5)+
scale_fill_manual(values = c('firebrick3','grey50'))+
theme(axis.text.x = element_text(angle = 90, hjust = 1),
plot.title = element_text(hjust = 0.5))
plot + geom_bar(stat = 'identity') + theme_xf +
labs(title = 'test',x=NULL) +
geom_text(aes(y = count),vjust = -0.5, size =3.5)+
scale_fill_manual(values = c('firebrick3','grey50'))+
ylim(0,max(plot.table$count *1.2))+
theme(axis.text.x = element_text(angle = 90, hjust = 1),
plot.title = element_text(hjust = 0.5))
plot + geom_bar(stat = 'identity') + theme_xf +
labs(title = 'test',x=NULL) +
geom_text(aes(y = count),vjust = -0.5, size =3.5)+
scale_fill_manual(values = c('firebrick3','grey50'))+
ylim(0,max(plot.table$count *1.1))+
theme(axis.text.x = element_text(angle = 90, hjust = 1),
plot.title = element_text(hjust = 0.5))
plot + geom_bar(stat = 'identity') + theme_xf +
labs(title = 'expression of genomic elements (rpkm > 0.1)',x=NULL, y = 'Count') +
geom_text(aes(y = count),vjust = -0.5, size =3.5)+
scale_fill_manual(values = c('firebrick3','grey50'))+
ylim(0,max(plot.table$count *1.1))+
theme(axis.text.x = element_text(angle = 90, hjust = 1),
plot.title = element_text(hjust = 0.5))
plot + geom_bar(stat = 'identity') + theme_xf +
labs(title = 'expression of genomic elements (rpkm > 0.1)',x=NULL, y = 'Count') +
geom_text(aes(y = count),vjust = -0.5, size =3.5)+
scale_fill_manual(values = c('firebrick3','grey50'))+
ylim(0,max(plot.table$count *1.1))+
theme(axis.text.x = element_text(angle = 90, hjust = 1),
plot.title = element_text(hjust = 0.5),
legend.position = c(.9,.75))
plot + geom_bar(stat = 'identity') + theme_xf +
labs(title = 'expression of genomic elements (rpkm > 0.1)',x=NULL, y = 'Count') +
geom_text(aes(y = count),vjust = -0.5, size =3.5)+
scale_fill_manual(values = c('firebrick3','grey50'))+
ylim(0,max(plot.table$count *1.1))+
theme(axis.text.x = element_text(angle = 90, hjust = 1),
plot.title = element_text(hjust = 0.5),
legend.position = c(.8,.75))
plot + geom_bar(stat = 'identity') + theme_xf +
labs(title = 'expression of genomic elements (rpkm > 0.1)',x=NULL, y = 'Count') +
geom_text(aes(y = count),vjust = -0.5, size =3.5)+
scale_fill_manual(values = c('firebrick3','grey50'))+
ylim(0,max(plot.table$count *1.1))+
theme(axis.text.x = element_text(angle = 90, hjust = 1),
plot.title = element_text(hjust = 0.5),
legend.position = c(.85,.75))
ggsave('figure/expressed_transcripts_TIP60.jpg', width = 6, height = 6, dpi =150, units = 'in')
dev.off()
plot <- ggplot(plot.table[count > 200,],aes(x =gene_type, y= N, fill = express, label = experc))
plot + geom_bar(stat = 'identity') + theme_xf +
labs(title = 'expression of genomic elements (rpkm > 0.1)',x=NULL, y = 'Count') +
geom_text(aes(y = count),vjust = -0.5, size =3.5)+
scale_fill_manual(values = c('firebrick3','grey50'))+
ylim(0,max(plot.table$count *1.1))+
theme(axis.text.x = element_text(angle = 90, hjust = 1),
plot.title = element_text(hjust = 0.5),
legend.position = c(.85,.75))
ggsave('figure/expressed_transcripts_TIP60.jpg', width = 6, height = 6, dpi =150, units = 'in')
?ggsave
ggsave(filename = 'figures/genome_expression.jpg', width = 6, height = 6, dpi =150, units = 'in')
library(plotly)
plot.table <- genetype.info
plot.table$gene_type <- paste0(plot.table$gene_type,'(',plot.table$count,')')
p <- plot_ly(plot.table,labels = ~gene_type, values = ~readsperc, type = 'pie',
textposition = 'outside',
textinfo = 'percent',
marker = list(colors = colors,
line = list(color = '#FFFFFF',
width = 1)))
p <- layout(p,
title = 'Distribution of GRO-seq reads on genomic elements',
margin = list(l=100,t=80,b=50),
showlegend = T)
p
plotly_IMAGE(p, width = 700, height = 700, out_file = 'figures/GRO-seq_reads_distribution.png')
Sys.setenv("plotly_username"="Feng_Xiong")
Sys.setenv("plotly_api_key"="cKUazDNFFbwzc7m8EGdj")
plotly_IMAGE(p, width = 700, height = 700, out_file = 'figures/GRO-seq_reads_distribution1.png')
DefExp
DefExp <-  function(counttable, groups, ref){
library(DESeq2)
dt <- counttable
condition <- groups
groupn <- length(groups)
count.table <- as.matrix(as.data.frame(dt)[,(ncol(dt)-groupn+1):ncol(dt)])
rownames(count.table) <- as.data.frame(dt)[,1] %>% as.character()
colData <- DataFrame(condition = condition,
row.names = colnames(count.table))
dds <- DESeqDataSetFromMatrix(countData = count.table,
colData = colData,
design = ~ condition)
dds$condition <- relevel(dds$condition, ref = ref)
dds <- DESeq(dds)
res <- results(dds)
res.table <- as.data.table(res)
res.table <- cbind(dt,res.table)
res.table
}
save(DefExp,file = 'r.func/DefExp.rdata')
exptable <- counttable[rpkm >= min.rpkm,]
res.deseq2 <- DefExp(exptable,groups = c('siCTL','siCTL','siTIP60','siTIP60'),ref = 'siCTL')
View(res.deseq2)
plot.table <- dif.deseq2
plot.table <- res.deseq2
plot.table$regulation <- 'NC'
plot.table[padj < 0.5 & log2FoldChange > 0,]$regulation <- 'Increase'
plot.table[padj < 0.5 & log2FoldChange < 0,]$regulation <- 'Decrease'
plot <- ggplot(plot.table,aes(x = gene_type, fill = regulation))
plot + geom_bar(width = 0.9) + theme_xf + theme(axis.text.x = element_text(angle = 90, hjust = 1))
genetype.info
plot.table <- res.deseq2[gene_type %in% genetype.info[count > 200]$gene_type,]
plot.table$regulation <- 'NC'
plot.table[padj < 0.5 & log2FoldChange > 0,]$regulation <- 'Increase'
plot.table[padj < 0.5 & log2FoldChange < 0,]$regulation <- 'Decrease'
plot <- ggplot(plot.table,aes(x = gene_type, fill = regulation))
plot + geom_bar(width = 0.9) + theme_xf + theme(axis.text.x = element_text(angle = 90, hjust = 1))
genetype.info
plot.table <- res.deseq2[gene_type %in% genetype.info[count > 200]$gene_type,]
plot.table$regulation <- 'NC'
plot.table[padj < 0.05 & log2FoldChange > 0,]$regulation <- 'Increase'
plot.table[padj < 0.05 & log2FoldChange < 0,]$regulation <- 'Decrease'
plot <- ggplot(plot.table,aes(x = gene_type, fill = regulation))
plot + geom_bar(width = 0.9) + theme_xf + theme(axis.text.x = element_text(angle = 90, hjust = 1))
plot + geom_bar(width = 0.9) + theme_xf + theme(axis.text.x = element_text(angle = 90, hjust = 1))+
scale_color_manual(values = c('coral1','coral2','coral3'))
plot + geom_bar(width = 0.9) + theme_xf + theme(axis.text.x = element_text(angle = 90, hjust = 1))+
scale_fill_manual(values = c('coral1','coral2','coral3'))
plot + geom_bar(width = 0.9) + theme_xf + theme(axis.text.x = element_text(angle = 90, hjust = 1))+
scale_fill_manual(values = c('coral1','coral2','azure4'))
genetype.major <- genetype.info[readsperc > 0.001 & count > 200,][order(-count)]$gene_type %>% as.character()
genetype.major
plot.table <- res.deseq2[gene_type %in% genetype.major,]
plot.table$regulation <- 'NC'
plot.table[padj < 0.05 & log2FoldChange > 0,regulation := 'Increase']
plot.table[padj < 0.05 & log2FoldChange < 0,regulation := 'Decrease']
colnames(res.deseq2)
plot <- ggplot(plot.table,aes(x = gene_type, fill = regulation))
plot + geom_bar(width = 0.9) + theme_xf + theme(axis.text.x = element_text(angle = 90, hjust = 1))
plot.table <- res.deseq2[gene_type %in% genetype.major,][,gene_type:=factor(gene_type,
levels = genetype.major)]
plot.table$regulation <- 'NC'
plot.table[padj < 0.05 & log2FoldChange > 0,regulation := 'Increase']
plot.table[padj < 0.05 & log2FoldChange < 0,regulation := 'Decrease']
plot.table[,regulation := factor(regulation, levels = c('Increase','Decrease','NC'))]
plot <- ggplot(plot.table,aes(x = gene_type, fill = regulation))
plot + geom_bar(width = 0.9) + theme_xf + theme(axis.text.x = element_text(angle = 90, hjust = 1))
plot.table$regulation <- 'NC'
plot.table[pvalue < 0.05 & log2FoldChange > 0,regulation := 'Increase']
plot.table[pvalue < 0.05 & log2FoldChange < 0,regulation := 'Decrease']
plot.table[,regulation := factor(regulation, levels = c('Increase','Decrease','NC'))]
plot <- ggplot(plot.table,aes(x = gene_type, fill = regulation))
plot + geom_bar(width = 0.9) + theme_xf + theme(axis.text.x = element_text(angle = 90, hjust = 1))
plot.table <- res.deseq2[gene_type %in% genetype.major,][,gene_type:=factor(gene_type,
levels = genetype.major)]
plot.table$regulation <- 'NC'
plot.table[pvalue < 0.05 & log2FoldChange > 0,regulation := 'Increase']
plot.table[pvalue < 0.05 & log2FoldChange < 0,regulation := 'Decrease']
plot.table[,regulation := factor(regulation, levels = c('Increase','Decrease','NC'))]
plot <- ggplot(plot.table,aes(x = gene_type, fill = regulation))
plot + geom_bar(width = 0.9) + theme_xf + theme(axis.text.x = element_text(angle = 90, hjust = 1))
scale_fill_manual(values = c('firebrick2','slateblute1','grey50')) +
theme(legend.position = c(.8,.9))
plot + geom_bar(width = 0.9) + theme_xf + theme(axis.text.x = element_text(angle = 90, hjust = 1))
plot + geom_bar(width = 0.9) + theme_xf + theme(axis.text.x = element_text(angle = 90, hjust = 1))+
labs(x =NULL)+
scale_fill_manual(values = c('firebrick2','slateblute1','grey50')) +
theme(legend.position = c(.8,.9))
plot + geom_bar(width = 0.9) + theme_xf + theme(axis.text.x = element_text(angle = 90, hjust = 1))+
labs(x =NULL)+
scale_fill_manual(values = c('firebrick2','slateblue1','grey50')) +
theme(legend.position = c(.8,.9))
plot + geom_bar(width = 0.9) + theme_xf + theme(axis.text.x = element_text(angle = 90, hjust = 1))+
labs(x =NULL)+
scale_fill_manual(values = c('firebrick2','royalblue3','grey20')) +
theme(legend.position = c(.8,.9))
plot + geom_bar(width = 0.9) + theme_xf + theme(axis.text.x = element_text(angle = 90, hjust = 1))+
labs(x =NULL)+
scale_fill_manual(values = c('firebrick2','royalblue3','grey80')) +
theme(legend.position = c(.8,.9))
plot + geom_bar(width = 0.9) + theme_xf + theme(axis.text.x = element_text(angle = 90, hjust = 1))+
labs(x =NULL)+
scale_fill_manual(values = c('firebrick2','royalblue3','grey60')) +
theme(legend.position = c(.8,.7))
plot + geom_bar(width = 0.9) + theme_xf + theme(axis.text.x = element_text(angle = 90, hjust = 1))+
labs(title = 'expression after siTIP60',x =NULL)+
scale_fill_manual(values = c('firebrick2','royalblue3','grey60')) +
theme(legend.position = c(.85,.7))
plot + geom_bar(width = 0.9) + theme_xf + theme(axis.text.x = element_text(angle = 90, hjust = 1))+
labs(title = 'expression after siTIP60',x =NULL)+
scale_fill_manual(values = c('firebrick2','royalblue3','grey60')) +
theme(legend.position = c(.85,.7),
plot.title = element_text(hjust = 0.5))
plot + geom_bar(width = 0.9) + theme_xf + theme(axis.text.x = element_text(angle = 90, hjust = 1))+
labs(title = 'expression after siTIP60 (p < 0.05)',x =NULL)+
scale_fill_manual(values = c('firebrick2','royalblue3','grey60')) +
theme(legend.position = c(.85,.7),
plot.title = element_text(hjust = 0.5))
ggsave('figures/dif_expressed_transcripts_siTIP60.jpg', width = 6, height = 6, dpi =150, units = 'in')
res.deseq2 <- plot.table
hk_gene <- fread('misc/HK_genes.txt')
head(hk_gene)
hk_gene <- fread('misc/HK_genes.txt',header = F)
head(res.deseq2)
hk_gene
hk_gene <- fread('misc/HK_genes.txt',header = F) %>% `colnames<-`(c('gene_name','refseq'))
test <- merge(res.deseq2,hk_gene,all.x = T)
hk_gene$housekp <- 'housekeeping'
test <- merge(res.deseq2,hk_gene,all.x = T)
res.deseq2 <- test
table(test[gene_type == 'protein_coding',]$housekp)
res.deseq2[housekp != 'housekeeping', housekp := 'other']
table(res.deseq2$housekp)
res.deseq2[housekp != 'housekeeping', housekp := 'other']
table(res.deseq2$housekp)
View(res.deseq2)
res.deseq2[is.na(refseq),housekp := 'other']
table(res.deseq2$housekp)
library(plotly)
p <- plot_ly(res.deseq2[gene_type == 'protein_coding',],labels = ~houskp, type = 'pie',
textposition = 'outside',
textinfo = 'percent',
marker = list(colors = colors,
line = list(color = '#FFFFFF',
width = 1)))
layout(p,
title = 'Distribution of GRO-seq reads on genomic elements',
margin = list(l=100,t=80,b=50),
showlegend = T)
colnames(res.deseq2)
p <- plot_ly(res.deseq2[gene_type == 'protein_coding',],labels = ~housekp, type = 'pie',
textposition = 'outside',
textinfo = 'percent',
marker = list(colors = colors,
line = list(color = '#FFFFFF',
width = 1)))
layout(p,
title = 'Distribution of GRO-seq reads on genomic elements',
margin = list(l=100,t=80,b=50),
showlegend = T)
p <- plot_ly(res.deseq2[gene_type == 'protein_coding',],labels = ~housekp, type = 'pie',
textposition = 'inside',
textinfo = 'percent',
marker = list(colors = colors,
line = list(color = '#FFFFFF',
width = 1)))
layout(p,
margin = list(l=100,t=80,b=50),
showlegend = T)
?plotly
p <- plot_ly(res.deseq2[gene_type == 'protein_coding',],labels = ~housekp, type = 'pie',
textposition = 'inside',
textinfo = 'label',
marker = list(colors = colors,
line = list(color = '#FFFFFF',
width = 1)))
layout(p,
margin = list(l=100,t=80,b=50),
showlegend = T)
plot.table <- res.deseq2[gene_type == 'protein_coding',][,.N,by=housekp]
plot.table
nrow(hk_gene)
# Load packages and functions needed ---------------------------------------------------
library(GenomicRanges)
library(magrittr)
library(ggplot2)
library(data.table)
library(RColorBrewer)
library(stringr)
plot.table <- res.deseq2[gene_type == 'protein_coding',][,.N,by=.(housekp,regulation)]
View(plot.table)
plot.table <- res.deseq2[gene_type == 'protein_coding',][,.N,by=.(housekp)]
plot.table
p <- plot_ly(plot.table,labels = ~housekp, type = 'pie',
textposition = 'inside',
textinfo = 'label',
marker = list(colors = colors,
line = list(color = '#FFFFFF',
width = 1)))
library(plotly)
p <- plot_ly(plot.table,labels = ~housekp, type = 'pie',
textposition = 'inside',
textinfo = 'label',
marker = list(colors = colors,
line = list(color = '#FFFFFF',
width = 1)))
layout(p,
margin = list(l=100,t=80,b=50),
showlegend = T)
p <- plot_ly(plot.table,labels = ~housekp,values= ~N, type = 'pie',
textposition = 'inside',
textinfo = 'label',
marker = list(colors = colors,
line = list(color = '#FFFFFF',
width = 1)))
layout(p,
margin = list(l=100,t=80,b=50),
showlegend = T)
layout(p, title = 'test',
margin = list(l=100,t=80,b=50),
showlegend = T)
p <- plot_ly(plot.table,labels = ~housekp,values= ~N, type = 'pie',
textposition = 'inside',
textinfo = 'label+percent',
marker = list(colors = colors,
line = list(color = '#FFFFFF',
width = 1)))
layout(p, title = 'test',
margin = list(l=100,t=80,b=50),
showlegend = T)
res.deseq2[is.na(refseq),housekp := 'regulated genes']
plot.table <- res.deseq2[gene_type == 'protein_coding',][,.N,by=.(housekp)]
p <- plot_ly(plot.table,labels = ~housekp,values= ~N, type = 'pie',
textposition = 'inside',
textinfo = 'label+percent',
marker = list(colors = colors,
line = list(color = '#FFFFFF',
width = 1)))
layout(p, title = 'Expressed genes',
margin = list(l=100,t=80,b=50),
showlegend = T)
p <- plot_ly(plot.table,labels = ~housekp,values= ~N, type = 'pie',
textposition = 'inside',
textinfo = 'label+percent',
insidetextfont = list(color = '#FFFFFF',
size = 3),
marker = list(colors = colors,
line = list(color = '#FFFFFF',
width = 1)))
layout(p, title = 'All expressing genes',
margin = list(l=100,t=80,b=50),
showlegend = T)
p <- plot_ly(plot.table,labels = ~housekp,values= ~N, type = 'pie',
textposition = 'inside',
textinfo = 'label+percent',
insidetextfont = list(color = '#FFFFFF',
size = 10),
marker = list(colors = colors,
line = list(color = '#FFFFFF',
width = 1)))
layout(p, title = 'All expressing genes',
margin = list(l=100,t=80,b=50),
showlegend = T)
p <- plot_ly(plot.table,labels = ~housekp,values= ~N, type = 'pie',
textposition = 'inside',
textinfo = 'label+percent',
insidetextfont = list(color = '#FFFFFF',
size = 20),
marker = list(colors = colors,
line = list(color = '#FFFFFF',
width = 1)))
layout(p, title = 'All expressing genes',
margin = list(l=100,t=80,b=50),
showlegend = T)
plotly_IMAGE(p, width = 700, height = 700, out_file = 'figures/All_expressed_hkgenes.png')
#If error, need:
Sys.setenv("plotly_username"="Feng_Xiong")
Sys.setenv("plotly_api_key"="cKUazDNFFbwzc7m8EGdj")
plotly_IMAGE(p, width = 700, height = 700, out_file = 'figures/All_expressed_hkgenes.png')
plotly_IMAGE(p, width = 500, height = 500, out_file = 'figures/All_expressed_hkgenes.png')
?plotly_IMAGE
plotly_IMAGE(p, width = 500, height = 500,format = 'jpeg', out_file = 'figures/All_expressed_hkgenes.jpeg')
layout(p, title = 'All expressing genes',
# margin = list(l=100,t=80,b=50),
showlegend = T)
layout(p, title = 'All expressing genes'
# margin = list(l=100,t=80,b=50),
# showlegend = T
)
layout(p, title = 'All expressing genes',
font = list(size =20)
# margin = list(l=100,t=80,b=50),
# showlegend = T
)
layout(p, title = 'All expressing genes',
font = list(size =20),
margin = list(t=100)
)
plotly_IMAGE(p, width = 1000, height = 800,format = 'jpeg', out_file = 'figures/All_expressed_hkgenes.jpeg')
plotly_IMAGE(p, width = 1000, height = 1200,format = 'jpeg', out_file = 'figures/All_expressed_hkgenes.jpeg')
plotly_IMAGE(p, width = 1000, height = 1200,format = 'png', out_file = 'figures/All_expressed_hkgenes.png')
p <- plot_ly(plot.table,labels = ~housekp,values= ~N, type = 'pie',
textposition = 'inside',
textinfo = 'label+value+percent',
insidetextfont = list(color = '#FFFFFF',
size = 20),
marker = list(colors = colors,
line = list(color = '#FFFFFF',
width = 1)))
layout(p, title = 'All expressing genes',
font = list(size =20),
margin = list(t=100)
)
p <- plot_ly(plot.table,labels = ~housekp,values= ~N, type = 'pie',
textposition = 'inside',
textinfo = 'value+label+percent',
insidetextfont = list(color = '#FFFFFF',
size = 20),
marker = list(colors = colors,
line = list(color = '#FFFFFF',
width = 1)))
layout(p, title = 'All expressing genes',
font = list(size =20),
margin = list(t=100)
)
p <- layout(p, title = 'All expressing genes',
font = list(size =20),
margin = list(t=100)
)
plotly_IMAGE(p, width = 1000, height = 1200,format = 'png', out_file = 'figures/All_expressed_hkgenes.png')
plotly_IMAGE(p, width = 800, height = 1000,format = 'png', out_file = 'figures/All_expressed_hkgenes.png')
plotly_IMAGE(p, width = 600, height = 800,format = 'png', out_file = 'figures/All_expressed_hkgenes.png')
plot.table <- res.deseq2[gene_type == 'protein_coding' & regulation == 'Decrease',][,.N,by=.(housekp)]
p <- plot_ly(plot.table,labels = ~housekp,values= ~N, type = 'pie',
textposition = 'inside',
textinfo = 'value+label+percent',
insidetextfont = list(color = '#FFFFFF',
size = 20),
marker = list(colors = colors,
line = list(color = '#FFFFFF',
width = 1)))
p <- layout(p, title = 'Genes decreased by siTIP60',
font = list(size =20),
margin = list(t=100)
)
p
plotly_IMAGE(p, width = 600, height = 800,format = 'png', out_file = 'figures/All_expressed_hkgenes.png')
plotly_IMAGE(p, width = 600, height = 800,format = 'png', out_file = 'figures/Genes_decreased_hkgenes.png')
plot.table <- res.deseq2[gene_type == 'protein_coding',][,.N,by=.(housekp)]
p <- plot_ly(plot.table,labels = ~housekp,values= ~N, type = 'pie',
textposition = 'inside',
textinfo = 'value+label+percent',
insidetextfont = list(color = '#FFFFFF',
size = 20),
marker = list(colors = colors,
line = list(color = '#FFFFFF',
width = 1)))
p <- layout(p, title = 'All expressing genes',
font = list(size =20),
margin = list(t=100)
)
plotly_IMAGE(p, width = 600, height = 800,format = 'png', out_file = 'figures/All_expressed_hkgenes.png')
plot.table <- res.deseq2[gene_type == 'protein_coding' & regulation == 'Decrease',][,.N,by=.(housekp)]
p <- plot_ly(plot.table,labels = ~housekp,values= ~N, type = 'pie',
textposition = 'inside',
textinfo = 'value+label+percent',
insidetextfont = list(color = '#FFFFFF',
size = 20),
marker = list(colors = colors,
line = list(color = '#FFFFFF',
width = 1)))
p <- layout(p, title = 'Genes decreased by siTIP60',
font = list(size =20),
margin = list(t=100)
)
plotly_IMAGE(p, width = 600, height = 800,format = 'png', out_file = 'figures/Genes_decreased_hkgenes.png')
plot.table <- res.deseq2[gene_type == 'protein_coding' & regulation == 'Increase',][,.N,by=.(housekp)]
p <- plot_ly(plot.table,labels = ~housekp,values= ~N, type = 'pie',
textposition = 'inside',
textinfo = 'value+label+percent',
insidetextfont = list(color = '#FFFFFF',
size = 20),
marker = list(colors = colors,
line = list(color = '#FFFFFF',
width = 1)))
p <- layout(p, title = 'Genes increased by siTIP60',
font = list(size =20),
margin = list(t=100)
)
p
plotly_IMAGE(p, width = 600, height = 800,format = 'png', out_file = 'figures/Genes_increased_hkgenes.png')
ImportBiopacks('topGO')
table(res.deseq2$gene_type)
# Write Increased/decreased genes to bed ----------------------------------
temp <- res.deseq2[gene_type == 'protein_coding' & regulation == 'NC',] %>% makeGRangesFromDataFrame()
head(temp)
length(temp)
table(temp$stand)
strand(temp)
strand(temp) %>% table
GR2BED(temp,'coordinates/NC_genes_siTIP60.bed')
temp <- res.deseq2[gene_type == 'protein_coding' & regulation == 'Increase',] %>% makeGRangesFromDataFrame()
GR2BED(temp,'coordinates/Increase_genes_siTIP60.bed')
head(temp)
temp <- res.deseq2[gene_type == 'protein_coding' & regulation == 'Decrease',] %>% makeGRangesFromDataFrame()
GR2BED(temp,'coordinates/Decrease_genes_siTIP60.bed')
head(temp)
temp <- res.deseq2[gene_type == 'enhancer' & regulation == 'NC',] %>% makeGRangesFromDataFrame()
GR2BED(temp,'coordinates/NC_enhancer_siTIP60.bed')
head(temp)
head(res.deseq2[gene_type == 'enhancer',])
temp <- res.deseq2[gene_type == 'enhancer',.N,by=.(gene_status,regulation)]
temp
temp <- res.deseq2[gene_type == 'enhancer' & regulation == 'NC',] %>% makeGRangesFromDataFrame()
GR2BED(temp,'coordinates/NC_enhancer_siTIP60.bed')
temp <- res.deseq2[gene_type == 'enhancer' & regulation == 'Increase',] %>% makeGRangesFromDataFrame()
GR2BED(temp,'coordinates/Increase_enhancer_siTIP60.bed')
temp <- res.deseq2[gene_type == 'enhancer' & regulation == 'Decrease',] %>% makeGRangesFromDataFrame()
GR2BED(temp,'coordinates/Decrease_enhancer_siTIP60.bed')
